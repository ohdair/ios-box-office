# iOS-Box-Office


|Title|Description|
|---|---|
í•œ ì¤„ ì†Œê°œ|ì˜í™”ì§„í¥ìœ„ì›íšŒ OpenAPIë¥¼ í™œìš©í•˜ì—¬ ì˜í™” ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤
í”„ë¡œì íŠ¸ ì§„í–‰ê¸°ê°„|23. 04. 24 ~ 23. 05. 16

## ğŸ“± êµ¬í˜„ í™”ë©´
|ì˜í™” ì„ íƒ|ë‚ ì§œ ì„ íƒ|
|---|---|
|![Simulator Screen Recording - iPhone 14 Pro - 2023-07-04 at 02 54 53](https://github.com/ohdair/ios-box-office/assets/79438622/2a46de8e-fe8b-440c-9d42-d2c48a4ef12e)|![Simulator Screen Recording - iPhone 14 Pro - 2023-07-04 at 02 55 19](https://github.com/ohdair/ios-box-office/assets/79438622/b9c29533-aa65-41fb-bbd8-79e061c4c4c1)|

## ğŸ“š Step ì„¤ëª…
### [ Step 1 ]
- ì˜í™”ì§„í¥ìœ„ì›íšŒì˜ ì¼ë³„ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ API ë¬¸ì„œì˜ ë°ì´í„° í˜•ì‹ì„ ê³ ë ¤í•˜ì—¬ ëª¨ë¸ íƒ€ì…ì„ êµ¬í˜„

- ì œê³µëœ JSON ë°ì´í„°ë¥¼ êµ¬í˜„í•œ Model íƒ€ì…ìœ¼ë¡œ Parsing í•  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(Unit Test)ë¥¼ ì§„í–‰



### [ Step 2 ]
- ë„¤íŠ¸ì›Œí¬ í†µì‹ ì„ ë‹´ë‹¹í•  íƒ€ì…ì„ ì„¤ê³„ ë° êµ¬í˜„

- ì˜í™”ì§„í¥ìœ„ì›íšŒì˜ ì¼ë³„ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ API ë¬¸ì„œì˜ ë°ì´í„° í˜•ì‹ì„ ê³ ë ¤í•˜ì—¬ ì„œë²„ì™€ ì‹¤ì œë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ë„ë¡ êµ¬í˜„

  - ì˜¤ëŠ˜ì˜ ì¼ì¼ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ì¡°íšŒ

  - ì˜í™” ê°œë³„ ìƒì„¸ ì¡°íšŒ



### [ Step 3 ]
- Step 2ì—ì„œ êµ¬í˜„í•œ ë„¤íŠ¸ì›Œí‚¹ ê¸°ëŠ¥ì„ í†µí•´ ì‹¤ì œë¡œ ìƒí’ˆëª©ë¡ì„ API ì„œë²„ì— ìš”ì²­

- ì–´ì œì˜ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” í™”ë©´ì„ êµ¬í˜„

- ë¦¬ìŠ¤íŠ¸ë¥¼ ì•„ë˜ë¡œ ì¡ì•„ëŒì–´ì„œ ë†“ìœ¼ë©´ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒˆë¡œê³ ì¹¨(ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨)

- ì²˜ìŒ ëª©ë¡ì„ ë¡œë“œí•  ë•Œ, ì‚¬ìš©ìì—ê²Œ ë¹ˆ í™”ë©´ë§Œ ë³´ì—¬ì£¼ëŠ” ëŒ€ì‹ , ë¡œë“œ ì¤‘ì„ì„ ì•Œ ìˆ˜ ìˆê²Œ ì²˜ë¦¬

- í™”ë©´ ìƒë‹¨ì—ëŠ” ë‚ ì§œë¥¼ í‘œê¸°

- ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ì •ë³´ë¥¼ í‘œê¸°

- ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ì •ë³´ì˜ ê° ì—´ì— í‘œê¸°í•  í•„ìˆ˜ì •ë³´

  - ë§¨ ì™¼ìª½ì—ëŠ” ì˜í™”ì˜ í˜„ì¬ ë“±ìˆ˜ë¥¼ í‘œê¸°

    - ì‹ ê·œ ì˜í™”ë©´ ë“±ìˆ˜ ì•„ë˜ì— ì‹ ì‘ì´ë¼ê³  í‘œê¸°

    - ê¸°ì¡´ ì˜í™”ë©´ ì–´ì œì™€ ë¹„êµí•œ ë“±ë½ì„ í‘œê¸°

      - ìˆœìœ„ ìƒìŠ¹ : ë¹¨ê°„ í™”ì‚´í‘œ + ë“±ë½ í¸ì°¨

      - ìˆœìœ„ í•˜ë½ : íŒŒë€ í™”ì‚´í‘œ + ë“±ë½ í¸ì°¨

      - ë³€ë™ ì—†ìŒ : - í‘œê¸°

  - í•´ë‹¹ ì¼ìì˜ ê´€ê°ìˆ˜ì™€ ëˆ„ì  ê´€ê°ìˆ˜ë¥¼ í‘œê¸°
  
    - ìˆ«ìê°€ ì„¸ ìë¦¬ ì´ìƒ ë„˜ì–´ê°€ë©´ ,ë¥¼ í™œìš©í•˜ì—¬ ì½ê¸° ì‰½ë„ë¡ ì²˜ë¦¬. ì˜ˆ) 10,000

### [ Step 4 ]

- ì˜í™”ì˜ ìƒì„¸ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” í™”ë©´ì„ êµ¬í˜„

- í‘œì‹œí•  ì˜í™” ì •ë³´

  - ì œëª©
  
  - í¬ìŠ¤í„° ì´ë¯¸ì§€
  - ê°ë…
  - ì œì‘ë…„ë„
  - ê°œë´‰ì¼
  - ìƒì˜ì‹œê°„
  - ê´€ëŒë“±ê¸‰
  - ì œì‘êµ­ê°€
  - ì¥ë¥´
  - ë°°ìš°
- ì˜í™” í¬ìŠ¤í„° ì´ë¯¸ì§€ëŠ” ë‹¤ìŒ ì´ë¯¸ì§€ ê²€ìƒ‰ APIë¥¼ í™œìš©í•©ë‹ˆë‹¤
  - ì˜í™” í¬ìŠ¤í„° ì´ë¯¸ì§€ëŠ” [ì˜í™”ì œëª©] + [ì˜í™” í¬ìŠ¤í„°]ë¡œ ì´ë¯¸ì§€ ê²€ìƒ‰í•˜ì—¬ ì œì¼ ì²« ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤
    - ì˜ˆ) "ì‹¤ë¯¸ë„ ì˜í™” í¬ìŠ¤í„°" ê²€ìƒ‰
  - ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ê¸° ì „ì—ëŠ” ì´ë¯¸ì§€ê°€ ë¡œë“œì¤‘ì„ì„ ì•Œ ìˆ˜ ìˆë„ë¡ ì ì ˆíˆ ì²˜ë¦¬í•´ì£¼ì„¸ìš”
- ë‚´ìš©ì´ ê¸¸ì–´ì§€ë©´ ìœ„ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤ í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•´ì£¼ì„¸ìš”

### [ Step 5 ]

- ë‚ ì§œë¥¼ ì„ íƒí•˜ê³ , ì„ íƒí•œ ë‚ ì§œì— ë”°ë¼ ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ì •ë³´ë¥¼ ìƒˆë¡œ ìˆ˜ì‹ í•˜ì—¬ í™”ë©´ì— í‘œì‹œ
- ì„ íƒí•  ìˆ˜ ìˆëŠ” ë‚ ì§œëŠ” ì˜¤ëŠ˜ê¹Œì§€ë¡œ ì œí•œ
- ë‚ ì§œì„ íƒ í™”ë©´ì˜ ë‹¬ë ¥ì—ëŠ” í˜„ì¬ ì„ íƒëœ ë‚ ì§œê°€ ë¯¸ë¦¬ ì„ íƒ

## ğŸ““ í•™ìŠµë‚´ìš© ìš”ì 
1. ë„¤íŠ¸ì›Œí‚¹ì„ í†µí•œ ë°ì´í„°ë¥¼ DTOë¡œ ë³€í™˜ í›„, í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  ìš”ì†Œë“¤ë§Œ ë½‘ì•„ì„œ Modelë¡œ ë³€í™˜
2. ìˆœìœ„ ë“±ë½ì„ í‘œê¸°í•  ë–„, stackViewë¡œ ë ˆì´ì•„ì›ƒì„ ì„¤ì •í•˜ì§€ ì•Šê³  AttributedStringì„ ì´ìš©í•˜ì—¬ imageë¥¼ textë¡œ ì…ë ¥í•˜ë„ë¡ ë³€ê²½
   
   <img src="https://user-images.githubusercontent.com/79438622/237252302-b0d90328-1b81-4d68-b6df-1fa91d787d90.png">  <img src="https://user-images.githubusercontent.com/79438622/237252312-69cf981b-829f-478b-91a2-ac21fe129db9.png">
```Swift
private func rankStatusText(_ rank: Rank) -> NSAttributedString {
    if rank.isEntry {
        return NSAttributedString(string: "ì‹ ì‘", attributes: [.foregroundColor: UIColor.systemPink])
    }

    return varianceStatusText(of: rank.variance)
}

private func varianceStatusText(of variance: Int) -> NSAttributedString {
    let attributedString = NSMutableAttributedString(string: "")
    let imageAttachment = NSTextAttachment()

    if variance > 0 {
        imageAttachment.image = UIImage(systemName: "arrowtriangle.up.fill")?.withTintColor(.systemRed)
        attributedString.append(NSAttributedString(string: String(variance)))
    } else if variance < 0 {
        imageAttachment.image = UIImage(systemName: "arrowtriangle.down.fill")?.withTintColor(.systemBlue)
        attributedString.append(NSAttributedString(string: String(abs(variance))))
    } else {
        imageAttachment.image = UIImage(systemName: "minus")?.withTintColor(.gray)
    }
    attributedString.insert(NSAttributedString(attachment: imageAttachment), at: 0)

    return attributedString
}
```
3. APIë§ˆë‹¤ HTTPCodeì— ê°’ì„ ë˜ì§€ë”ë¼ë„ ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë‹¬ë¼ì§€ëŠ” ê²ƒì„ í™•ì¸í•´ì„œ ì„œë²„ ì—ëŸ¬ ë°ì´í„° íƒ€ì…
```Swift
struct ErrorDTO: Decodable {
    let message: String?

    func convert(with httpCode: Int) -> HTTPError? {
        guard let message = message else { return nil }
        switch httpCode {
        case 200:
            return HTTPError.requestError(message: message)
        case 400:
            return HTTPError.requestError(message: message)
        case 401:
            return HTTPError.authenticationError(message: message)
        case 403:
            return HTTPError.authorizationPermissonError(message: message)
        case 500, 502:
            return HTTPError.systemError(message: message)
        case 503:
            return HTTPError.serviceMaintenance(message: message)
        default:
            return HTTPError.notFound
        }
    }
}
```

## ğŸš€ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
1. ë„¤íŠ¸ì›Œí‚¹ì„ í†µí•´ DTOë¥¼ ë³€í™˜í•˜ëŠ” ê³¼ì •, ì‹¤íŒ¨ì— ëŒ€í•œ ì—ëŸ¬ë¥¼ í™•ì¸í–ˆì§€ë§Œ ì†ì„± ì¤‘ì— ì–´ë””ì„œ ë¬¸ì œê°€ ìƒê²¼ëŠ”ì§€ ì°¾ëŠ”ë° ì˜¤ë˜ ê±¸ë¦¬ëŠ” ë¬¸ì œê°€ ë°œìƒ
   
   ìˆ˜ë™ìœ¼ë¡œ ë””ì½”ë”©í•˜ë„ë¡ ë³€ê²½, íŠ¹ì • ì†ì„±ì—ì„œ ë¬¸ì œê°€ ìƒê¸°ë©´ throws ë˜ë©° í•´ê²°
   
   [ê³µì‹ ë¬¸ì„œ](https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types)
```Swift
extension DailyBoxOfficeDTO {
    init(from decoder: Decoder) throws {
        let container = try decoder.container(keyedBy: CodingKeys.self)
        index = try container.decode(String.self, forKey: .index)
        rank = try container.decode(String.self, forKey: .rank)
        rankVariance = try container.decode(String.self, forKey: .rankVariance)
        rankOldAndNew = try container.decode(String.self, forKey: .rankOldAndNew)
        movieCode = try container.decode(String.self, forKey: .movieCode)
        movieName = try container.decode(String.self, forKey: .movieName)
        releaseDate = try container.decode(String.self, forKey: .releaseDate)
        salesAmount = try container.decode(String.self, forKey: .salesAmount)
        salesShare = try container.decode(String.self, forKey: .salesShare)
        salesVariance = try container.decode(String.self, forKey: .salesVariance)
        salesChange = try container.decode(String.self, forKey: .salesChange)
        salesAccumulate = try container.decode(String.self, forKey: .salesAccumulate)
        audiencePerDay = try container.decode(String.self, forKey: .audiencePerDay)
        audienceVariance = try container.decode(String.self, forKey: .audienceVariance)
        audienceChange = try container.decode(String.self, forKey: .audienceChange)
        audienceAccumlate = try container.decode(String.self, forKey: .audienceAccumlate)
        screenCount = try container.decode(String.self, forKey: .screenCount)
        showCount = try container.decode(String.self, forKey: .showCount)
    }
}
```
